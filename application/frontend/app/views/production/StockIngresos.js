var tipo=0;var valor=null;Ext.define("MyDesktop.app.views.StockIngresos",{extend:"Ext.grid.Panel",alias:"widget.wstockingresos",requires:["MyDesktop.app.stores.StockActual"],id:"wstockingresos",initComponent:function(){storestockactual=Ext.create("MyDesktop.app.stores.StockActual");var a=this;Ext.apply(a,{layout:"fit",id:"dgvStockActual",sortableColumns:false,store:storestockactual,columns:[{text:"Fecha Compra",flex:0.5,sortable:true,dataIndex:"fecha",align:"center"},{text:"Producto",flex:3,sortable:true,dataIndex:"producto",align:"left"},{text:"Precio de Compra",flex:0.9,sortable:true,dataIndex:"preciocompra",align:"right"},{text:"Codigo Bobina",flex:0.9,sortable:true,dataIndex:"bobina",align:"center"},{xtype:"numbercolumn",text:"Total Metro Lineal",flex:1,sortable:true,dataIndex:"metrolineal",align:"right"},{xtype:"numbercolumn",text:"Total Salidas (METROS)",flex:1,sortable:true,dataIndex:"totalsalida",align:"right"},{xtype:"numbercolumn",text:"Stock Actual (METROS)",flex:1,sortable:true,dataIndex:"stockactual",align:"right"}],listeners:{itemclick:function(d,b,f,c,g){}},tbar:[{xtype:"button",text:"Imprimir",iconCls:"boton-print",disabled:false,id:"btnImprimirStockActual",handler:function(){}},"-",{xtype:"button",text:"Actualizar Lista",iconCls:"icon-grid",id:"btnActualizarListaStockActual",listeners:{click:function(){Ext.getCmp("dgvStockActual").getStore().reload()}}},{xtype:"combobox",fieldLabel:"Filtrar",id:"btnComboFiltroStockActual",flex:0.5,labelWidth:35,valueField:"id",displayField:"descripcion",emptyText:"----- Seleccionar ----",query:"local",editable:false,listeners:{select:function(f,b,d){if(f.getValue()==0||f.getValue()==1){Ext.getCmp("txtBuscadorCompras").focus(true,200);Ext.getCmp("txtBuscadorCompras").setDisabled(false);Ext.getCmp("txtBuscadorCompras").setValue("")}else{Ext.getCmp("txtBuscadorCompras").focus(false,200);Ext.getCmp("txtBuscadorCompras").setDisabled(true);Ext.getCmp("txtBuscadorCompras").setValue("");var e=f.getValue();var c=Ext.getCmp("txtBuscadorCompras").getValue();tipo=e;valor=c}}}},{xtype:"textfield",id:"txtBuscadorStockActual",hasfocus:true,disabled:true,flex:0.5,listeners:{specialkey:function(d,g){if(g.getKey()==g.ENTER){var c=Ext.getCmp("btnComboFiltroCompras").getValue();var b=d.getValue();tipo=c;valor=b;a.filtrarGrillaCompras(c,b);a.getCalcularTotalesListado(c,b)}}}},"-",{xtype:"label",text:"Buscar Fecha"},{xtype:"datefield",value:new Date(),id:"dpFechaCompraStockActual",format:"d/m/Y",flex:0.3,listeners:{change:function(e,d,b){var c=Ext.Date.format(e.getValue(),"d/m/Y");tipo=2;valor=c.toString()}}}]});this.callParent(arguments)},imprimirReporteStockActual:function(){try{var b=Ext.getCmp("dgvContratos");var c=b.getSelectionModel().getSelection()[0].get("idcontrato")}catch(d){MyDesktop.app.util.Util.showErrorMsg("No ha selecionado un contrato registrado!");return false}var a="reportes/imprimirdocumentoventa/"+parseInt(c).toString();xpos=(screen.width/2)-(1000/2);ypos=(screen.height/2)-(600/2);my=window.open(a,"mywindow","location=1,status=1,scrollbars=1,  width=1000,height=600");my.moveTo(xpos,ypos)}});